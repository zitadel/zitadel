{
  "$schema": "../node_modules/nx/schemas/project-schema.json",
  "targets": {
    "lint": {
      "description": "Runs all linters",
      "dependsOn": [
        "lint-check-*"
      ]
    },
    "lint-check-prettier": {
      "description": "Checks code formatting with Prettier",
      "cache": true,
      "inputs": [
        "default"
      ]
    },
    "lint-check-ng": {
      "description": "Runs Angular specific lint checks",
      "cache": true,
      "inputs": [
        "default"
      ]
    },
    "generate": {
      "description": "Generates code from protobuf definitions for API v1 endpoints",
      "inputs": [
        "{workspaceRoot}/proto/**/*",
        "{projectRoot}/buf.gen.yaml",
        "{projectRoot}/package.json",
        "{workspaceRoot}/pnpm-lock.yaml"
      ],
      "outputs": [
        "{projectRoot}/src/app/proto/generated"
      ]
    },
    "build": {
      "description": "Builds the Management Console for production",
      "inputs": [
        "{projectRoot}/**/*",
        "!{projectRoot}/dist/**/*",
        "!{projectRoot}/.angular/**/*",
        "{workspaceRoot}/pnpm-lock.yaml"
      ],
      "outputs": [
        "{projectRoot}/dist",
        "{projectRoot}/.angular"
      ]
    },
    "archive": {
      "description": "Packages the Console build into an archive",
      "dependsOn": [
        "build"
      ],
      "executor": "nx:run-commands",
      "options": {
        "parallel": false,
        "env": {
          "BUILD_DIR": "{projectRoot}/dist",
          "PACK_DIR": "{workspaceRoot}/.artifacts/pack"
        },
        "commands": [
          "mkdir -p ${PACK_DIR}",
          "tar -czf ${PACK_DIR}/zitadel-console.tar.gz -C ${BUILD_DIR} ."
        ]
      },
      "cache": true,
      "outputs": [
        "{workspaceRoot}/.artifacts/pack/zitadel-console.tar.gz"
      ]
    },
    "pack": {
      "description": "Aggregates all packaging tasks",
      "dependsOn": [
        "archive"
      ]
    },
    "dev": {
      "description": "Runs the Management Console in development mode with hot-reloading",
      "continuous": true,
      "dependsOn": [
        "generate",
        "^build"
      ]
    }
  }
}