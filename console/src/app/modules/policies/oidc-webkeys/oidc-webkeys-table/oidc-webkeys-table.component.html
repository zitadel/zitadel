<cnsl-refresh-table (refreshed)="refresh.emit()" [loading]="(dataSource$ | async) === null">
  <div actions>
    <ng-content></ng-content>
  </div>
  <div class="table-wrapper">
    @if (dataSource$ | async; as dataSource) {
      <table mat-table class="table" aria-label="Elements" [dataSource]="dataSource">
        <ng-container matColumnDef="state">
          <th mat-header-cell *matHeaderCellDef>{{ 'APP.PAGES.STATE' | translate }}</th>
          <td mat-cell *cnslCellDef="let row; let i = index; dataSource: dataSource">
            <span
              class="state"
            [ngClass]="{
              active: i === 0,
              neutral: i === 1,
            }"
              >
              @switch (i) {
                @case (0) {
                  {{ 'DESCRIPTIONS.SETTINGS.WEB_KEYS.TABLE.ACTIVE' | translate }}
                }
                @case (1) {
                  {{ 'DESCRIPTIONS.SETTINGS.WEB_KEYS.TABLE.NEXT' | translate }}
                }
                @default {
                  {{ 'DESCRIPTIONS.SETTINGS.WEB_KEYS.TABLE.FUTURE' | translate }}
                }
              }
            </span>
          </td>
        </ng-container>
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef>{{ 'APP.PAGES.ID' | translate }}</th>
          <td mat-cell *cnslCellDef="let row; dataSource: dataSource">
            {{ row.id }}
          </td>
        </ng-container>
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef>{{ 'PROJECT.TYPE.TITLE' | translate }}</th>
          <td mat-cell *cnslCellDef="let row; dataSource: dataSource">
            {{ row.key.case | uppercase }}
          </td>
        </ng-container>
        <ng-container matColumnDef="actions" stickyEnd>
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *cnslCellDef="let row; dataSource: dataSource">
            @if (row.state === State.INITIAL) {
              <cnsl-table-actions>
                <button
                  actions
                  matTooltip="{{ 'ACTIONS.REMOVE' | translate }}"
                  color="warn"
                  (click)="delete.emit(row)"
                  mat-icon-button
                  >
                  <i class="las la-trash"></i>
                </button>
              </cnsl-table-actions>
            }
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="['state', 'id', 'type', 'actions']"></tr>
        <tr mat-row *matRowDef="let row; columns: ['state', 'id', 'type', 'actions']"></tr>
      </table>
    }
  </div>
</cnsl-refresh-table>
