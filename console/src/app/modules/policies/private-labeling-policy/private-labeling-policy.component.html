<app-detail-layout [backRouterLink]="[ serviceType === PolicyComponentServiceType.ADMIN ? '/iam/policies' : '/org']"
    [title]="'POLICY.PRIVATELABELING.TITLE' | translate" [description]="'POLICY.PRIVATELABELING.DESCRIPTION' | translate">

    <p class="default" *ngIf="isDefault"> {{'POLICY.DEFAULTLABEL' | translate}}</p>

    <div class="spinner-wr">
        <mat-spinner diameter="30" *ngIf="loading" color="primary"></mat-spinner>
    </div>

    <ng-template appHasRole [appHasRole]="['policy.delete']">
        <button *ngIf="serviceType === PolicyComponentServiceType.MGMT && !isDefault"
            matTooltip="{{'POLICY.RESET' | translate}}" color="warn" (click)="removePolicy()" mat-stroked-button>
            {{'POLICY.RESET' | translate}}
        </button>
    </ng-template>

    <div *ngIf="data" class="content">
      <mat-accordion class="settings">
        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">branding_watermark</mat-icon>Logo</div>
            </mat-panel-title>
            <mat-panel-description>
              
            </mat-panel-description>
          </mat-expansion-panel-header>

          <p class="description">Your Logo will be used in the Login itself, while the icon is used for smaller UI elements like in the organisation switcher in console</p>
          
          <span class="title">Dark Design</span>
          <div class="logo-setup-wrapper">
            <div class="part">
              <span class="label">Logo</span>
              <div class="dropzone" cnslDropzone  (hovered)="toggleHoverLogo(Theme.DARK, $event)"
              (dropped)="onDropLogo(Theme.DARK, $event)"
              [class.hovering]="isHoveringOverDarkLogo">
                <label class="file-label">
                  <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropLogo(Theme.DARK, $event.target.files)">
                  <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                  <i class="icon las la-cloud-upload-alt"></i>
                  <span class="desc">{{isHoveringOverDarkLogo ? 'Release': 'Drop your Logo here'}}</span>
                </label>
            </div>
            </div>

            <div class="part">
              <span class="label">Icon</span>
              <div class="dropzone" cnslDropzone (hovered)="toggleHoverIcon(Theme.DARK, $event)"
              (dropped)="onDropIcon(Theme.DARK, $event)"
              [class.hovering]="isHoveringOverDarkIcon">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropIcon(Theme.DARK, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverDarkIcon ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>
          </div>

          <span class="title">Light Design</span>

          <div class="logo-setup-wrapper">
            <div class="part">
              <span class="label">Logo</span>
              <div class="dropzone" cnslDropzone  (hovered)="toggleHoverLogo(Theme.LIGHT, $event)"
              (dropped)="onDropLogo(Theme.LIGHT, $event)"
              [class.hovering]="isHoveringOverLightLogo">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropLogo(Theme.LIGHT, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverLightLogo ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>

            <div class="part">
              <span class="label">Icon</span>
              <div class="dropzone" cnslDropzone (hovered)="toggleHoverIcon(Theme.LIGHT,$event)"
              (dropped)="onDropIcon(Theme.LIGHT, $event)"
              [class.hovering]="isHoveringOverLightIcon">
              <label class="file-label">
                <input #selectedFile style="display: none;"  class="file-input" type="file" (change)="onDropIcon(Theme.LIGHT, $event.target.files)">
                <input class="btn" mat-raised-button type="button" [value]="'POLICY.PRIVATELABELING.BTN' | translate" (click)="selectedFile.click();" />

                <i class="icon las la-cloud-upload-alt"></i>
                <span class="desc">{{isHoveringOverLightIcon ? 'Release': 'Drop your Logo here'}}</span>
              </label>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">palette</mat-icon>Colors</div>
            </mat-panel-title>
          </mat-expansion-panel-header>

          <span>Dark Design</span>

          <div class="colors">
            <div class="color">
              <!-- <span class="title">Primary Color</span> -->
              <cnsl-form-field class="formfield">
                <cnsl-label>Primary Color Hexcode</cnsl-label>
                <input cnslInput [(ngModel)]="data.primaryColorDark" />
              </cnsl-form-field>
              <div class="color-selector">
                <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                    [ngClass]="{'active': data.primaryColorDark == color.color}"
                    (click)="data.primaryColorDark= color.color" [ngStyle]="{'background-color': color.color}">
                    <mat-icon *ngIf="data.primaryColorDark == color.color">check</mat-icon>
                </div>
              </div>
            </div>

            <div class="color">
              <!-- <span class="title">Secondary Color</span> -->
              <cnsl-form-field class="formfield">
                <cnsl-label>Secondary Color Hexcode</cnsl-label>
                <input cnslInput [(ngModel)]="data.secondaryColorDark" />
              </cnsl-form-field>
              <div class="color-selector">
                <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                  [ngClass]="{'active': data.secondaryColorDark == color.color}"
                  (click)="data.secondaryColorDark= color.color" [ngStyle]="{'background-color': color.color}">
                  <mat-icon *ngIf="data.secondaryColorDark == color.color">check</mat-icon>
                </div>
              </div>
            </div>

            <div class="color">
              <!-- <span class="title">Warn Color</span> -->
              <cnsl-form-field class="formfield">
                <cnsl-label>Warn Color Hexcode</cnsl-label>
                <input cnslInput [(ngModel)]="data.warnColorDark" />
              </cnsl-form-field>
              <div class="color-selector">
                <div *ngFor="let color of warncolors" class="circle mat-elevation-z3"
                  [ngClass]="{'active': data.warnColorDark == color.color}"
                  (click)="data.warnColorDark= color.color" [ngStyle]="{'background-color': color.color}">
                  <mat-icon *ngIf="data.warnColorDark == color.color">check</mat-icon>
                </div>
              </div>
            </div>
        </div>

        <span>Light Design</span>

        <div class="colors">
          <div class="color">
            <!-- <span class="title">Primary Color</span> -->
            <cnsl-form-field class="formfield">
              <cnsl-label>Primary Color Hexcode</cnsl-label>
              <input cnslInput [(ngModel)]="data.primaryColor" />
            </cnsl-form-field>
            <div class="color-selector">
              <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                  [ngClass]="{'active': data.primaryColor == color.color}"
                  (click)="data.primaryColor= color.color" [ngStyle]="{'background-color': color.color}">
                  <mat-icon *ngIf="data.primaryColor == color.color">check</mat-icon>
              </div>
            </div>
          </div>

          <div class="color">
            <!-- <span class="title">Secondary Color</span> -->
            <cnsl-form-field class="formfield">
              <cnsl-label>Secondary Color Hexcode</cnsl-label>
              <input cnslInput [(ngModel)]="data.secondaryColor" />
            </cnsl-form-field>
            <div class="color-selector">
              <div *ngFor="let color of colors" class="circle mat-elevation-z3"
                [ngClass]="{'active': data.secondaryColor == color.color}"
                (click)="data.secondaryColor= color.color" [ngStyle]="{'background-color': color.color}">
                <mat-icon *ngIf="data.secondaryColor == color.color">check</mat-icon>
              </div>
            </div>
          </div>

          <div class="color">
            <!-- <span class="title">Warn Color</span> -->
            <cnsl-form-field class="formfield">
              <cnsl-label>Warn Color Hexcode</cnsl-label>
              <input cnslInput [(ngModel)]="data.warnColor" />
            </cnsl-form-field>
            <div class="color-selector">
              <div *ngFor="let color of warncolors" class="circle mat-elevation-z3"
                [ngClass]="{'active': data.warnColor == color.color}"
                (click)="data.warnColor= color.color" [ngStyle]="{'background-color': color.color}">
                <mat-icon *ngIf="data.warnColor == color.color">check</mat-icon>
              </div>
            </div>
          </div>
      </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header class="header">
            <mat-panel-title>
              <div class="panel-title"><mat-icon class="icon">text_fields</mat-icon>Font</div>
            </mat-panel-title>
            <!-- <mat-panel-description>
              {{fontCssRule}}
            </mat-panel-description> -->
          </mat-expansion-panel-header>
          <div class="fonts">
            <div class="font-preview" [style.font-family]="fontCssRule">
              <mat-icon>text_fields</mat-icon>
              <span>ABC • abc • 123</span>
              <span>_</span>
              <span>Select your favorite font for the UI</span>
            </div>
            <cnsl-form-field class="formfield">
              <cnsl-label>CSS Rule for font-family</cnsl-label>
              <input cnslInput [(ngModel)]="fontCssRule" />
            </cnsl-form-field>
            <div class="font-selector">
              <button matTooltip="{{f.name}}" *ngFor="let f of fonts" class="font"
                [ngClass]="{'active': fontCssRule == f.css}" [style.font-family]="f.css"
                (click)="fontCssRule = f.css">
                Aa
            </button>
            </div>
        </div>
        </mat-expansion-panel>

        <mat-expansion-panel class="expansion">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="panel-title">
              <mat-icon class="icon">accessibility_new</mat-icon>Advanced Behavior
            </div>
            </mat-panel-title>
            <!-- <mat-panel-description>
              Currently I am {{panelOpenState ? 'open' : 'closed'}}
            </mat-panel-description> -->
          </mat-expansion-panel-header>
          <div class="adv-container" *ngIf="data">
          <mat-slide-toggle class="toggle" color="primary" ngDefaultControl
            [(ngModel)]="data.hideLoginNameSuffix">
            {{'POLICY.DATA.HIDELOGINNAMESUFFIX' | translate}}
        </mat-slide-toggle>
        <mat-slide-toggle class="toggle" color="primary" ngDefaultControl
            [(ngModel)]="data.errorMsgPopup">
            {{'POLICY.DATA.ERRORMSGPOPUP' | translate}}
        </mat-slide-toggle>
        <mat-slide-toggle class="toggle" color="primary" ngDefaultControl
            [(ngModel)]="data.disableWatermark">
            {{'POLICY.DATA.DISABLEWATERMARK' | translate}}
        </mat-slide-toggle>
      </div>
        </mat-expansion-panel>
      </mat-accordion>

      <div class="preview">
        <span class="label">PREVIEW</span>
        <div class="dashed" [style.font-family]="fontCssRule">
          <div class="login-wrapper">
            <img *ngIf="logoURL; else defaultDarkLogo" class="light" [src]="logoURL" alt="logo-mock" />
            <ng-template #defaultDarkLogo>
              <img class="light" src="../../../../assets/images/zitadel-logo-dark.svg" alt="logo-mock" />
            </ng-template>
          
            <img *ngIf="logoURL; else defaultLightLogo" class="dark" [src]="logoURL" alt="logo-mock" />
            <ng-template #defaultLightLogo>
              <img class="dark" src="../../../../assets/images/zitadel-logo-light.svg" alt="logo-mock" />
            </ng-template>
            <h1>Anmeldung</h1>
            <p class="desc">mit ZITADEL Konto anmelden</p>
            <cnsl-form-field class="formfield">
              <cnsl-label>Loginname</cnsl-label>
              <input cnslInput value="road.runner"/>
            </cnsl-form-field>

            <div class="btn-wrapper">
              <button mat-stroked-button>cancel</button>
              <button class="dark" mat-raised-button [style.background]="data.primaryColorDark" [style.color]="data.primaryColorDark == '#ffffff' ? '#000000' : '#ffffff'">Login</button>
              <button class="light" mat-raised-button [style.background]="data.primaryColor" [style.color]="data.primaryColor == '#ffffff' ? '#000000' : '#ffffff'">Login</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="btn-container">
        <button (click)="savePolicy()" color="primary" type="submit" mat-raised-button>{{ 'ACTIONS.SAVE' | translate
            }}</button>
    </div>

    <cnsl-links *ngIf="nextLinks" [links]="nextLinks"></cnsl-links>
</app-detail-layout>