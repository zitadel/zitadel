{
  "$schema": "./node_modules/nx/schemas/project-schema.json",
  "projectType": "application",
  "targets": {
    "nx-release-publish": {
      "description": "Runs repo scoped release tasks. Uploads checksums for all released artifacts to the GitHub release, configures the org scope for publishing GitHub Packages and triggers version bump action runs in the Helm chart and homebrew tap repos.",
      "dependsOn": [
        "@zitadel/api:nx-release-publish",
        "@zitadel/login:nx-release-publish"
      ],
      "executor": "nx:run-commands",
      "options": {
        "parallel": true,
        "commands": [
          {
            "forwardAllArgs": false,
            "prefix": "[uploading checksums to GitHub release] ",
            "command": "bash -c \"[[ \\\"${NX_DRY_RUN}\\\" == \\\"true\\\" ]] || cd .artifacts/pack && rm -f checksums.txt && sha256sum * > checksums.txt && gh release upload ${ZITADEL_RELEASE_VERSION} checksums.txt\""
          },
          {
            "forwardAllArgs": false,
            "prefix": "[bumping homebrew tap version on original zitadel/zitadel release, not on forks] ",
            "command": "bash -c \"[[ \\\"${NX_DRY_RUN}\\\" == \\\"true\\\" ]] || [[ \\\"${ZITADEL_RELEASE_GITHUB_REPO}\\\" != \\\"zitadel/zitadel\\\" ]] || gh workflow --repo zitadel/homebrew-tap run update.yml -f runId=${RUN_ID} -f version=${ZITADEL_RELEASE_VERSION}\""
          },
          {
            "forwardAllArgs": false,
            "prefix": "[bumping chart version on original zitadel/zitadel release, not on forks] ",
            "command": "bash -c \"[[ \\\"${NX_DRY_RUN}\\\" == \\\"true\\\" ]] || [[ \\\"${ZITADEL_RELEASE_GITHUB_REPO}\\\" != \\\"zitadel/zitadel\\\" ]] || gh workflow --repo zitadel/zitadel-charts run bump.yml\""
          }
        ]
      }
    },
    "db": {
      "continuous": true,
      "description": "Runs a local Postgres database for development",
      "command": "nx run @zitadel/devcontainer:compose up db"
    },
    "clean": {
      "description": "Cleans all local-only files relating to the Zitadel platform (API, Login and Console)",
      "dependsOn": [
        "@zitadel/api:clean",
        "@zitadel/login:clean",
        "@zitadel/console:clean"
      ]
    }
  }
}